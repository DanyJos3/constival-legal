---
/**
 * Header - Navigation matching sas-facil-front style
 */
import { navigationItems } from '../data/services';
---

<header>
  <nav 
    class="fixed z-20 w-full transition-all duration-300"
    id="main-nav"
    data-scrolled="false"
  >
    <div class="m-auto max-w-7xl px-6">
      <div class="flex flex-wrap items-center justify-between gap-6 py-3 lg:gap-0 lg:py-4">
        
        <!-- Logo & Mobile Toggle -->
        <div class="flex w-full justify-between lg:w-auto">
          <a href="/" aria-label="Constival - Inicio" class="flex items-center  group">
            <img 
              src="/icon-apple.png" 
              alt="Constival Logo" 
              class="logo-icon w-8 h-8 sm:w-10 sm:h-10 rounded-xl transition-all duration-300 group-hover:scale-105"
            />
            <span class="sm:flex items-baseline gap-1 text-xl sm:text-2xl  logo-text">
              Constival
              <!-- <span class="logo-accent text-lg font-normal opacity-70">Asesoría Legal</span> -->
            </span>
          </a>

          <!-- Mobile Menu Button -->
          <button
            type="button"
            id="mobile-menu-button"
            aria-label="Abrir menú"
            aria-expanded="false"
            class="relative z-20 -m-2.5 -mr-4 block cursor-pointer p-2.5 lg:hidden mobile-toggle transition-colors duration-300"
          >
            <svg id="menu-icon-open" class="size-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <svg id="menu-icon-close" class="size-6 hidden absolute inset-0 m-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- Desktop Navigation -->
        <div 
          id="nav-menu"
          class="nav-menu mb-6 hidden w-full flex-wrap items-center justify-end space-y-8 rounded-3xl border p-6 shadow-2xl md:flex-nowrap lg:m-0 lg:flex lg:w-fit lg:gap-6 lg:space-y-0 lg:border-transparent lg:bg-transparent lg:p-0 lg:shadow-none transition-all duration-300"
        >
          <div class="lg:pr-4">
            <ul class="space-y-6 text-base lg:flex lg:gap-8 lg:space-y-0 lg:text-sm">
              {navigationItems.map((item) => (
                <li>
                  <a 
                    href={item.href}
                    class="nav-link block duration-150 transition-colors"
                  >
                    {item.label}
                  </a>
                </li>
              ))}
            </ul>
          </div>

          <!-- <div class="flex w-full flex-col space-y-3 sm:flex-row sm:gap-3 sm:space-y-0 md:w-fit lg:border-l lg:pl-6 nav-divider transition-colors duration-300">
            <a 
              href={ctaButton.href}
              class="btn btn-primary btn-sm btn-pill btn-icon-right"
            >
              Hablar con un asesor
              <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
              </svg>
            </a>
          </div> -->
        </div>
      </div>
    </div>
  </nav>
</header>

<style>
  /* Logo icon filter */
  .logo-icon {
    filter: brightness(0.85) saturate(0.9);
    transition: filter 0.3s ease, transform 0.3s ease;
  }
  
  .group:hover .logo-icon {
    filter: brightness(1) saturate(1);
  }

  /* Initial state: transparent header (for hero with image) */
  #main-nav[data-scrolled="false"] {
    background-color: transparent;
    border-color: transparent;
  }
  
  #main-nav[data-scrolled="false"] .logo-text {
    color: white;
  }
  
  #main-nav[data-scrolled="false"] .mobile-toggle {
    color: white;
  }
  
  #main-nav[data-scrolled="false"] .nav-link {
    color: rgba(255, 255, 255, 0.7);
  }
  
  #main-nav[data-scrolled="false"] .nav-link:hover {
    color: white;
  }
  
  #main-nav[data-scrolled="false"] .nav-divider {
    border-color: var(--color-border-hover);
  }
  
  /* Scrolled state: solid background */
  #main-nav[data-scrolled="true"] {
    background-color: var(--color-primary-dark-95);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--color-border-default);
    box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.3);
  }
  
  #main-nav[data-scrolled="true"] .logo-text {
    color: var(--color-text-primary);
  }
  
  #main-nav[data-scrolled="true"] .mobile-toggle {
    color: var(--color-text-primary);
  }
  
  #main-nav[data-scrolled="true"] .nav-link {
    color: var(--color-text-secondary);
  }
  
  #main-nav[data-scrolled="true"] .nav-link:hover {
    color: var(--color-text-primary);
  }
  
  #main-nav[data-scrolled="true"] .nav-divider {
    border-color: var(--color-border-default);
  }
  
  /* Mobile menu styles */
  .nav-menu {
    background-color: var(--color-primary-dark);
    border-color: var(--color-border-default);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);
  }
  
  @media (min-width: 1024px) {
    .nav-menu {
      background-color: transparent;
      border-color: transparent;
      box-shadow: none;
    }
  }
  
  /* Mobile menu active state */
  .nav-menu.active {
    display: block;
  }
</style>

<script>
  // Header scroll behavior
  const nav = document.getElementById('main-nav');
  
  function updateNavOnScroll() {
    if (!nav) return;
    
    const scrollThreshold = window.innerHeight * 0.3;
    const isScrolled = window.scrollY > scrollThreshold;
    
    nav.setAttribute('data-scrolled', isScrolled ? 'true' : 'false');
  }
  
  window.addEventListener('scroll', updateNavOnScroll, { passive: true });
  updateNavOnScroll();
  
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const navMenu = document.getElementById('nav-menu');
  const menuIconOpen = document.getElementById('menu-icon-open');
  const menuIconClose = document.getElementById('menu-icon-close');
  
  let isMenuOpen = false;
  
  mobileMenuButton?.addEventListener('click', () => {
    isMenuOpen = !isMenuOpen;
    
    if (isMenuOpen) {
      navMenu?.classList.add('active');
      navMenu?.classList.remove('hidden');
      menuIconOpen?.classList.add('hidden');
      menuIconClose?.classList.remove('hidden');
      mobileMenuButton?.setAttribute('aria-expanded', 'true');
    } else {
      navMenu?.classList.remove('active');
      navMenu?.classList.add('hidden');
      menuIconOpen?.classList.remove('hidden');
      menuIconClose?.classList.add('hidden');
      mobileMenuButton?.setAttribute('aria-expanded', 'false');
    }
  });
  
  // Close menu on link click
  navMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      if (isMenuOpen) {
        mobileMenuButton?.click();
      }
    });
  });
</script>
